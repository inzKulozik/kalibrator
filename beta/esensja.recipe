#!/usr/bin/env  python

__license__   = 'GPL v3'
__copyright__ = u'2010, Tomasz Dlugosz <tomek3d@gmail.com>'
'''
esensja.pl
'''

from calibre.web.feeds.news import BasicNewsRecipe
import re

class Esensja(BasicNewsRecipe):
    title          = u'Esensja.pl'
    publisher      = u'Esensja.pl'
    description    = u'Magazyn kultury popularnej'
    language = 'pl'
    __author__ = u'Tomasz D\u0142ugosz'
    simultaneous_downloads = 1
    oldest_article = 7
    max_articles_per_feed = 100
    use_embedded_content = False

    feeds          = [(u'Esensja Tw\xf3rczo\u015b\u0107', u'feed://esensja.pl/rss/tworczosc.rss'), (u'Esensja Ksi\u0105\u017cka', u'http://esensja.pl/rss/ksiazka.rss'), (u'Esensja Film', u'http://esensja.pl/rss/film.rss'), (u'Esensja Komiks', u'http://esensja.pl/rss/komiks.rss'), (u'Esensja Gry', u'http://esensja.pl/rss/gry.rss'), (u'Esensja Muzyka', u'http://esensja.pl/rss/muzyka.rss'), (u'Esensja Varia', u'http://esensja.pl/rss/varia.rss')]

    keep_only_tags = [dict(name='div', attrs={'id':'panel_tekst_2'})]

    remove_attributes = ['width', 'height']

    remove_tags = [
        dict(name='div', attrs={'class':'hb-google'}),
        dict(name='div', attrs={'class':'wykop'}),
        dict(name='div', attrs={'class':'wykop'}),
        dict(name='div', attrs={'id':'komentarze'}),
        dict(name='div', attrs={'class':'leady'}),
        dict(name='div', attrs={'id':'panel_tekst_3'})]

    preprocess_regexps = [(re.compile(r'<h1>Najnowsze</h1>', re.DOTALL|re.IGNORECASE), lambda m: '')]
